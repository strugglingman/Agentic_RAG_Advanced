# ==============================================================================
# Python logging configuration
# ==============================================================================
LOG_LEVEL=DEBUG
LOG_FORMAT="%(asctime)s - %(correlation_id)s - %(funcName)s - %(lineno)d - %(message)s"
LOG_PATH="logs/app.log"

# ==============================================================================
# Flask Application Settings
# ==============================================================================
FLASK_ENV=development
FLASK_SECRET=your-flask-secret-key-here
DEBUG=true
TESTING=false

# ==============================================================================
# OpenAI API Configuration
# ==============================================================================
OPENAI_API_KEY=sk-your-openai-api-key-here

# ==============================================================================
# LangSmith Tracing & Monitoring
# ==============================================================================
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=your-langchain-api-key-here
LANGCHAIN_PROJECT=agentic-rag-chatbot
LANGCHAIN_ENDPOINT=https://eu.api.smith.langchain.com

# ==============================================================================
# LangGraph Configuration
# ==============================================================================
CHECKPOINT_ENABLED=false

# ==============================================================================
# Embedding & Reranking Models
# ==============================================================================
# Embedding provider: "openai" (recommended) or "local"
EMBEDDING_PROVIDER=openai
# For OpenAI: text-embedding-3-small (1536-dim) or text-embedding-3-large (3072-dim)
OPENAI_EMBEDDING_MODEL="text-embedding-3-small"
# For local provider (if EMBEDDING_PROVIDER=local):
EMBEDDING_MODEL_NAME="sentence-transformers/all-MiniLM-L6-v2"
# Reranker: use BAAI/bge-reranker-v2-m3 for multilingual, BAAI/bge-reranker-base for English
RERANKER_MODEL_NAME="BAAI/bge-reranker-base"

# ==============================================================================
# Vector Database (ChromaDB)
# ==============================================================================
CHROMA_PATH="chroma_db"

# ==============================================================================
# PostgreSQL Database (Conversations & Checkpoints)
# ==============================================================================
DATABASE_URL="postgresql://user:password@localhost:5432/chatbot?schema=chatbot"
CHECKPOINT_POSTGRES_DATABASE_URL="postgresql://user:password@localhost:5432/chatbot"
CONVERSATION_MESSAGE_LIMIT=200

# ==============================================================================
# Redis Cache
# ==============================================================================
REDIS_URL=redis://localhost:6379
REDIS_CACHE_TTL=3600
REDIS_CACHE_LIMIT=15

# ==============================================================================
# Retrieval & Search Settings
# ==============================================================================
USE_HYBRID=true
USE_RERANKER=true
TOP_K=8
CANDIDATES=50
FUSE_ALPHA=0.5

# Quality thresholds for hybrid search and reranking
MIN_HYBRID=0.1
AVG_HYBRID=0.1
MIN_SEM_SIM=0.35
AVG_SEM_SIM=0.2
MIN_RERANK=0.5
AVG_RERANK=0.3

# ==============================================================================
# Document Processing & Chunking
# ==============================================================================
SENT_TARGET=1600
SENT_OVERLAP=250
TEXT_MAX=-1

# ==============================================================================
# Chat Settings
# ==============================================================================
CHAT_MAX_TOKENS=16000
MAX_HISTORY=6

# ==============================================================================
# File Upload Configuration
# ==============================================================================
UPLOAD_BASE="uploads"
UPLOAD_DIR="uploads"
MAX_UPLOAD_MB=25
ALLOWED_EXTENSIONS="txt,pdf,docx,md"
MIME_TYPES="text/plain,text/markdown,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.openxmlformats-officedocument"
FOLDER_SHARED="shared"
DEPT_SPLIT="|"

# ==============================================================================
# Authentication & Authorization
# ==============================================================================
SERVICE_AUTH_SECRET=your-service-auth-secret-here
SERVICE_AUTH_ISSUER=your_service_name
SERVICE_AUTH_AUDIENCE=your_service_audience

# ==============================================================================
# Organization Structure
# ==============================================================================
ORG_STRUCTURE_FILE="org_structure.json"

# ==============================================================================
# Rate Limiting
# ==============================================================================
RATELIMIT_STORAGE_URI="memory://"
DEFAULT_RATE_LIMITS="500 per day,20 per minute"

# ==============================================================================
# MCP (Model Context Protocol) Settings
# ==============================================================================
USE_MCP=false
BRAVE_API_KEY=your-brave-api-key-here
MCP_THRESHOLD=0.5
MCP_SERVER_COMMAND="npx -y @modelcontextprotocol/server-brave-search"

# ==============================================================================
# Web Search Configuration
# ==============================================================================
WEB_SEARCH_ENABLED=false
# Provider: "tavily" (recommended, requires API key) or "duckduckgo" (free)
WEB_SEARCH_PROVIDER=duckduckgo
WEB_SEARCH_MAX_RESULTS=5
TAVILY_API_KEY=your-tavily-api-key-here

# ==============================================================================
# Self-Reflection / Retrieval Evaluation
# ==============================================================================
USE_SELF_REFLECTION=true

# Performance mode: "fast", "balanced", "thorough"
# - "fast": Heuristics only, no LLM (~50ms, cheap)
# - "balanced": Light LLM check (~500ms, moderate) - RECOMMENDED
# - "thorough": Full LLM evaluation (~2s, expensive)
REFLECTION_MODE=balanced

# Quality thresholds (0.0-1.0)
REFLECTION_THRESHOLD_EXCELLENT=0.85
REFLECTION_THRESHOLD_GOOD=0.70
REFLECTION_THRESHOLD_PARTIAL=0.50

# Minimum number of contexts required
REFLECTION_MIN_CONTEXTS=1

# Automatic action flags
REFLECTION_AUTO_REFINE=true
REFLECTION_AUTO_EXTERNAL=false

# Maximum refinement attempts (prevents infinite loops)
REFLECTION_MAX_REFINEMENT_ATTEMPTS=3

# ==============================================================================
# SMTP EMAIL CONFIGURATION
# ==============================================================================
SMTP_SERVER="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password-here

# ==============================================================================
# Slack Configuration
# ==============================================================================
SLACK_ENABLED=false
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token-here
SLACK_SIGNING_SECRET=your-slack-signing-secret-here
BOT_BACKEND_URL=http://localhost:5001

# ==============================================================================
# Download Settings
# ==============================================================================
DOWNLOAD_BASE=downloads
MAX_DOWNLOAD_SIZE_MB=100
DOWNLOAD_TIMEOUT=30
